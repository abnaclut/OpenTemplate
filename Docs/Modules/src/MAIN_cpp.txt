TODO: document every part of main.cpp